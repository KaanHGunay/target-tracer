os:
  - linux
services:
  - docker
language: node_js
node_js:
  - 12.13.1
cache:
  directories:
    - node
    - node_modules
    - '$HOME/.m2'
env:
  global:
    - NODE_VERSION=12.13.1
    - SPRING_OUTPUT_ANSI_ENABLED=ALWAYS
    - SPRING_JPA_SHOW_SQL=false
    - JHI_DISABLE_WEBPACK_LOGS=true
    - NG_CLI_ANALYTICS="false"
    - MAVEN_USER_HOME=$HOME/.m2/repository/
addons:
  sonarcloud:
    organization: 'kaanhgunay'
    token:
      secure: 'xd8Q+vqIQEZnJpd8S9NIERzBoooOQFWAVT4D2RRNSZ21KU6XoHNBJqTft7dRkGJIyZxYCMvrRh9PObb9jd4kv8DMrPRy9l4ND+HMLEt7leW0CyMlVaxNGrKs7zTjOwEqlVorwfpVoYinViH9BInTAt1ZxKQAIRE4LmQ44ByY1YcwVl9sOB1AlThbO/mmcH2u28/vxn0rDWFU/xwdiCBwjKijkqhDuAH6Jc1ZytPlM+B33c7pnEkJDcfYoagGy1+6ZMLTVqGS1vG+L92V1A6Ron3QQXyaWGRTKSjHMpMeU8J009qcv6xq+YmLn5ZN+d26gb1CI6l4TGAp4/r6ZpNZa2P5YTnB9R4odACxewvvfqcjbg1mQ/yTpnr0C3nO2K/bGfYDabUWGOFE0k0zAj3iUL+9ulUe19N3rxdsOT2cdDR4gVLGN5ATMVQF3ZOE7cbhhaAaLCu4B1ZWh8RAO+t+nyPvyXVtWCQ3T+CtSqxVwQFX+h6FLfFBR2S9usNKBl/r6R0/LVREBGLxYO06ztek3AT4Lf5ZqHjKsIkL8GAkwLdjS1ei8g1fQTApLwY6e4l8UOTpqKh9+fHDfXrAWVXvxFjrptoDdeNI6tadPr1SIufJKTWTl8ytucX1iOCionl3yjC8Lccj5aE53ppu/K3ReuEiMXjtFg/+tNsj7Xroa7Y='
before_install:
  - |
    if [[ $JHI_JDK = '8' ]]; then
      echo '*** Using OpenJDK 8'
    else
      echo '*** Using OpenJDK 11 by default'
      sudo add-apt-repository ppa:openjdk-r/ppa -y
      sudo apt-get update -q
      sudo apt-get install -y openjdk-11-jdk -y
      sudo update-java-alternatives -s java-1.11.0-openjdk-amd64
      java -version
    fi
  - java -version
  - sudo /etc/init.d/mysql stop
  - sudo /etc/init.d/postgresql stop
  - nvm install $NODE_VERSION
  - npm install -g npm
  - node -v
  - npm -v
install:
  - npm install
script:
  - chmod +x mvnw
  - './mvnw -ntp checkstyle:check'
  - './mvnw -ntp clean verify'
  - "./mvnw -ntp com.github.eirslett:frontend-maven-plugin:npm -Dfrontend.npm.arguments='run
    test' -Dmaven.repo.local=$MAVEN_USER_HOME"
  - mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar -Dsonar.projectKey=KaanHGunay_target-tracer
  - './mvnw -ntp verify -Pprod -DskipTests'
notifications:
  webhooks:
    on_success: change
    on_failure: always
    on_start: false
